 In the Kingdom of Springfieldia, the Serfsons receive a visit by a horseman passing through their house on his horse, after which Milhouse invites the family to the city walls where newly severed heads are being added. The family visits Jacqueline Bouvier at The Webs at Giant Spider Acres, a retirement forest, and then go to the walls where Marge discovers that her mother's body is freezing over. At Barber Hibbert's Surgery, Krusty is found with genital Snerfs, while Jacqueline is found with progressive frozen mortification, having being bitten by an ice-walker. In order to save her, Krusty proposes a treatment, buying an Amulet of Warmfyre. However, the family is unable to afford it, and Marge tells Homer to raise the necessary money. At Moe's, Moe receives a message attached to a crow, which turns out to be a prank from Bart. At the Springfieldia Human Power Plant, Homer and the others are working as slaves for Lord Montgomery, pushing a manual power generator wheel. Homer sneaks off to ask for money from Montgomery, but is turned down. Lisa takes Homer into an alley to tell him that she has a solution. With the use of magic, she turns a piece of lead into gold, however, she can't use her powers or the King will take her away and turn her into a sinister wizard. The King is seen with his evil wizards scolding at them for creating an All-Smelling Tower instead of an all-seeing eye. Bart is then seen killing Milhouse clones with a ball and chain just for pleasure. Back at home, Marge gives the amulet to her mother, but she tells Marge that she just wants to die because of having lived a long life. In the end, she agrees to live and they celebrate, eating Hobbits. The family is reunited and thrilled until Sorcererintendant Chalmers comes in demanding that they hand Lisa over to the king, as she has been a witch. Lisa is taken away to the King, while leaving Janey behind. Homer is willing to get her back and leads the people of Springfieldia to a revolt. They arrive at the walls of the castle, but are stopped when the door closes. Treestache, along with other walking and talking trees, agrees to help them by tearing the walls down, but they are chopped down to make ladders in order to scale the walls. A big battle starts, and many of the locals are killed, before Jacqueline sacrifices herself to extinguish the fire in the dragon, withdrawing the amulet, transforming into an ice statue and melting inside of the dragon. The people discover that extinguishing the dragon's fire removes the magic from the world, to their dismay, including magical creatures. Reluctant to bring science into the world, Homer relights the fire in the dragon's mouth, which then burns the village. 